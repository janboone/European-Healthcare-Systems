<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Getting Eurostat and OECD data on health and healthcare systems</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jan Boone" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<link rel="stylesheet" href="https://latex.now.sh/prism/prism.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>

<script type="text/javascript" src="http://orgmode.org/org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "2");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "showall");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
// @license-end
</script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Getting Eurostat and OECD data on health and healthcare systems</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org850858b">1. Preamble code</a></li>
<li><a href="#orgf8cc964">2. Introduction</a></li>
<li><a href="#orgd6c75fb">3. OECD data</a>
<ul>
<li><a href="#org0ddddfd">3.1. Health systems data</a></li>
<li><a href="#orgf600b79">3.2. Avoidable hospital admissions</a></li>
</ul>
</li>
<li><a href="#org98bcb29">4. Economic and health variables</a>
<ul>
<li><a href="#orgdfa5f88">4.1. Treatable and preventable mortality of residents by cause and sex [hlth_cd_apr]</a>
<ul>
<li><a href="#orgaecdf36">4.1.1. for robustness analysis</a></li>
</ul>
</li>
<li><a href="#org10efd40">4.2. Economic indicators</a>
<ul>
<li><a href="#orgb781709">4.2.1. Main GDP aggregates per capita [nama_10_pc]</a></li>
<li><a href="#org3dd269f">4.2.2. income quantiles [icw_res_02]</a></li>
</ul>
</li>
<li><a href="#orgee3154c">4.3. healthcare expenditures by function [hlth_sha11_hc]</a></li>
<li><a href="#org3ac3018">4.4. lifestyle determinants of health</a>
<ul>
<li><a href="#orga6fa6f7">4.4.1. Body mass index (BMI) by sex, age and income quintile [hlth_ehis_bm1]</a></li>
<li><a href="#org9df8a18">4.4.2. Daily smokers of cigarettes by sex, age and income quintile [hlth_ehis_sk3i]</a></li>
<li><a href="#org8b5a1cc">4.4.3. Frequency of heavy episodic drinking by sex, age and educational attainment level [hlth_ehis_al3e]</a></li>
</ul>
</li>
<li><a href="#orgbb826cc">4.5. number of doctors and nurses</a>
<ul>
<li><a href="#org3a78d96">4.5.1. doctors [hlth_rs_prs1]</a></li>
<li><a href="#orgae94b9d">4.5.2. nurses [hlth_rs_prsns]</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgfde219c">5. merging European data</a>
<ul>
<li><a href="#org2b1fa4f">5.1. merging the health and economic data</a></li>
<li><a href="#orga6db0b2">5.2. merging with systems data</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="PREFACE" id="orgdfedfd2">

</div>

<div id="outline-container-org850858b" class="outline-2">
<h2 id="org850858b"><span class="section-number-2">1</span> Preamble code</h2>
<div class="outline-text-2" id="text-1">
<p>
Run this code first before running the code of particular data sets. It imports the relevant libraries.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #5317ac;">import</span> numpy <span style="color: #5317ac;">as</span> np
<span style="color: #5317ac;">import</span> pandas <span style="color: #5317ac;">as</span> pd
<span style="color: #5317ac;">from</span> country_codes <span style="color: #5317ac;">import</span> oecd_dictionary, eurostat_dictionary
<span style="color: #5317ac;">import</span> eurostat

<span style="color: #00538b;">EU_countries</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">'Belgium'</span>, <span style="color: #2544bb;">'Bulgaria'</span>, <span style="color: #2544bb;">'Czechia'</span>, <span style="color: #2544bb;">'Denmark'</span>,
<span style="color: #2544bb;">'Germany (until 1990 former territory of the FRG)'</span>, <span style="color: #2544bb;">'Germany'</span>,<span style="color: #2544bb;">'Estonia'</span>,
<span style="color: #2544bb;">'Ireland'</span>, <span style="color: #2544bb;">'Greece'</span>, <span style="color: #2544bb;">'Spain'</span>, <span style="color: #2544bb;">'France'</span>, <span style="color: #2544bb;">'Croatia'</span>, <span style="color: #2544bb;">'Italy'</span>,
<span style="color: #2544bb;">'Cyprus'</span>, <span style="color: #2544bb;">'Latvia'</span>, <span style="color: #2544bb;">'Lithuania'</span>, <span style="color: #2544bb;">'Luxembourg'</span>, <span style="color: #2544bb;">'Hungary'</span>, <span style="color: #2544bb;">'Malta'</span>,
<span style="color: #2544bb;">'Netherlands'</span>, <span style="color: #2544bb;">'Austria'</span>, <span style="color: #2544bb;">'Poland'</span>, <span style="color: #2544bb;">'Portugal'</span>, <span style="color: #2544bb;">'Romania'</span>,
<span style="color: #2544bb;">'Slovenia'</span>, <span style="color: #2544bb;">'Slovakia'</span>, <span style="color: #2544bb;">'Finland'</span>, <span style="color: #2544bb;">'Sweden'</span>, <span style="color: #2544bb;">'United Kingdom'</span>,
<span style="color: #2544bb;">'Iceland'</span>, <span style="color: #2544bb;">'Liechtenstein'</span>, <span style="color: #2544bb;">'Norway'</span>, <span style="color: #2544bb;">'Switzerland'</span>,
<span style="color: #2544bb;">'Bosnia and Herzegovina'</span><span style="color: #145c33;">]</span>

</pre>
</div>
</div>
</div>


<div id="outline-container-orgf8cc964" class="outline-2">
<h2 id="orgf8cc964"><span class="section-number-2">2</span> Introduction</h2>
<div class="outline-text-2" id="text-2">
<p>
In this file we explain how we get the data and from where and at the same time we generate the data. If the data is generated in this way, a change in the data by either the OECD or Eurostat will lead to (slightly) different results.
</p>
</div>
</div>

<div id="outline-container-orgd6c75fb" class="outline-2">
<h2 id="orgd6c75fb"><span class="section-number-2">3</span> OECD data</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org0ddddfd" class="outline-3">
<h3 id="org0ddddfd"><span class="section-number-3">3.1</span> Health systems data</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The OECD Health Systems Characteristics Survey can be found on this <a href="http://qdd.oecd.org/data/HSC">page</a>.
</p>

<p>
Click the <code>Excel Download</code> button and save the file in the folder <code>./raw_data</code>. When this data was downloaded, the filename was <code>HSC_22012021_110424.xlsx</code>. Adjust the filename in the code below, if necessary.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #00538b;">data</span> = pd.read_excel<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./raw_data/HSC_22012021_110424.xlsx'</span>,<span style="color: #2544bb;">'Table View'</span>,header=<span style="color: #5317ac;">[</span>0,1<span style="color: #5317ac;">]</span>,index_col=<span style="color: #5317ac;">[</span>0<span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">data_t</span> = data.T
<span style="color: #00538b;">rename_columns</span> = data_t.rename<span style="color: #145c33;">(</span>index=oecd_dictionary,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
data_t.rename<span style="color: #145c33;">(</span>index=<span style="color: #5317ac;">{</span><span style="color: #2544bb;">'2012 - OECD countries (2012)'</span>:2012,<span style="color: #2544bb;">'2016 - OECD countries (2016)'</span>:2016,<span style="color: #2544bb;">'2018 - Latin American countries (2018)'</span>:2018
<span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
data_t.rename_axis<span style="color: #145c33;">(</span><span style="color: #5317ac;">(</span><span style="color: #2544bb;">'Country'</span>,<span style="color: #2544bb;">'Year'</span><span style="color: #5317ac;">)</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
data_t.reset_index<span style="color: #145c33;">(</span>inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
</pre>
</div>

<p>
Some countries only have data in one year (2012 or 2016; the year 2018 refers to non-oecd countries in latin america), some in both years but then they are (almost) identical. Hence we select only one year.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">oecd_data</span> = data_t.query<span style="color: #145c33;">(</span><span style="color: #2544bb;">'Year == 2012 | Year == 2016'</span><span style="color: #145c33;">)</span>.drop_duplicates<span style="color: #145c33;">(</span>subset=<span style="color: #2544bb;">'Country'</span>, keep = <span style="color: #2544bb;">'last'</span><span style="color: #145c33;">)</span>
</pre>
</div>

<p>
The next code block generates the dataframe on health system features that we use in the paper.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = pd.DataFrame<span style="color: #145c33;">()</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">'Country'</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'Year_system_date'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">'Year'</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'single payer system'</span><span style="color: #145c33;">]</span> = <span style="color: #145c33;">(</span>oecd_data<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'2.a. What is the main source of basic health care coverage in your country? (Q2)'</span><span style="color: #5317ac;">]</span>.isin<span style="color: #5317ac;">(</span><span style="color: #005a5f;">[</span><span style="color: #2544bb;">'A national health system covering the country as a whole'</span>,<span style="color: #2544bb;">'A single health insurance fund (single-payer model)'</span><span style="color: #005a5f;">]</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'inpatient public'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">'31.a. Are physicians supplying in-patient specialist services predominantly (Q31a)'</span><span style="color: #145c33;">]</span>.isin<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'Publically employed'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'outpatient public'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">"25a. Are outpatient specialists' services provided predominantly in: (Q25a)"</span><span style="color: #145c33;">]</span>.isin<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'Outpatient departments of public hospitals'</span>,<span style="color: #2544bb;">'Public multi-specialty clinic'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'public primary care'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">"29.a. Are physicians supplying primary care services predominantly (Q29a)"</span><span style="color: #145c33;">]</span>.isin<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'Publically employed'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'free hospital choice'</span><span style="color: #145c33;">]</span> = <span style="color: #145c33;">(</span>oecd_data<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'40.a. Are patient usually free to choose hospitals for in-patient care? (Q40a)'</span><span style="color: #5317ac;">]</span> == <span style="color: #2544bb;">'Patients can choose any hospital without any consequence for the level of coverage'</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">int</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'almost free hospital choice'</span><span style="color: #145c33;">]</span> = oecd_data<span style="color: #145c33;">[</span><span style="color: #2544bb;">'40.a. Are patient usually free to choose hospitals for in-patient care? (Q40a)'</span><span style="color: #145c33;">]</span> == <span style="color: #2544bb;">'Patients are free to choose any hospital but they have financial incentives to choose some providers, please specify'</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'public provider quality reports'</span><span style="color: #145c33;">]</span> = <span style="color: #145c33;">(</span>oecd_data<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'71. Are these metrics publicly reported at the provider level at least annually? (Q71)'</span><span style="color: #5317ac;">]</span> == <span style="color: #2544bb;">'Yes'</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">int</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'healthcare regulator'</span><span style="color: #145c33;">]</span> = <span style="color: #145c33;">(</span>oecd_data<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'66. Is there an organisation with responsibility for national policy on health care quality in your country? (Q66)'</span><span style="color: #5317ac;">]</span> == <span style="color: #2544bb;">'Yes'</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">int</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'ce analysis'</span><span style="color: #145c33;">]</span> = <span style="color: #145c33;">(</span>oecd_data<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'62.b. Do HTAs generally include results of economic evaluation? (Q62b)'</span><span style="color: #5317ac;">]</span> == <span style="color: #2544bb;">'Yes'</span><span style="color: #145c33;">)</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">int</span><span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/oecd_systems.csv'</span><span style="color: #145c33;">)</span>
<span style="color: #8f0075;">len</span><span style="color: #145c33;">(</span>df<span style="color: #145c33;">)</span>
</pre>
</div>

<pre class="example">
38
</pre>
</div>
</div>


<div id="outline-container-orgf600b79" class="outline-3">
<h3 id="orgf600b79"><span class="section-number-3">3.2</span> Avoidable hospital admissions</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<a class='org-ref-reference' href="#OECD_avoidable_hospitalizations">OECD_avoidable_hospitalizations</a> provides information on avoidable hospitalizations. 
</p>

<p>
Download the excell file Asthma and COPD hospital admission in adults, 2017 (or nearest year) at <a href="https://www.oecd-ilibrary.org/social-issues-migration-health/asthma-and-copd-hospital-admission-in-adults-2017-or-nearest-year_e1a68f0a-en">https://www.oecd-ilibrary.org/social-issues-migration-health/asthma-and-copd-hospital-admission-in-adults-2017-or-nearest-year_e1a68f0a-en</a> to the folder <code>./raw_data/</code>. Then copy-paste the table in this excel file to the following csv file: <a href="./raw_data/Asthma_COPD.csv">./raw_data/Asthma_COPD.csv</a>
</p>

<p>
With this csv file in place, we run the code below.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #00538b;">df</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./raw_data/Asthma_COPD.csv'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.Country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span> = pd.wide_to_long<span style="color: #145c33;">(</span>df, <span style="color: #5317ac;">[</span><span style="color: #2544bb;">"Asthma"</span><span style="color: #5317ac;">]</span>, i=<span style="color: #2544bb;">"Country"</span>, j=<span style="color: #2544bb;">"year"</span><span style="color: #145c33;">)</span>.reset_index<span style="color: #145c33;">()</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'Country'</span>:<span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'Asthma'</span>:<span style="color: #2544bb;">'avoidable hospitalizations'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/asthma_copd.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
   country  year  avoidable hospitalizations
0  Austria  2012                       287.9
1  Belgium  2012                       185.7
2  Denmark  2012                       336.7
3  Estonia  2012                        48.3
4  Finland  2012                       212.9
</pre>
</div>
</div>
</div>


<div id="outline-container-org98bcb29" class="outline-2">
<h2 id="org98bcb29"><span class="section-number-2">4</span> Economic and health variables</h2>
<div class="outline-text-2" id="text-4">
<p>
All variables in this section are from the Eurostat website: <a href="https://ec.europa.eu/eurostat/data/database">https://ec.europa.eu/eurostat/data/database</a>
</p>
</div>

<div id="outline-container-orgdfa5f88" class="outline-3">
<h3 id="orgdfa5f88"><span class="section-number-3">4.1</span> Treatable and preventable mortality of residents by cause and sex [hlth_cd_apr]</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Preventable mortality is defined as death that can be mainly avoided through public health and primary prevention interventions. Treatable (or amenable) mortality is defined as death that can be mainly avoided through health care interventions, including screening and treatment. Both indicators refer to premature mortality (under age 75). The data is based on the revised OECD/Eurostat lists.
</p>

<p>
"The (age-) standardised death rate is a weighted average of age-specific mortality rates. The weighting factor is the age distribution of a standard reference population. The standard reference population used is the European standard population (see annex European standard population - revision 2012) as defined by Eurostat in 2012." from section 3.4 of <a href="https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm#unit_measure1591105000535">https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm#unit_measure1591105000535</a>
</p>

<p>
<a href="https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm#stat_pres1601631715000">https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm#stat_pres1601631715000</a>: death rates are expressed per 100,000 population.
</p>

<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/data/database?node_code=hlth_cd_apr">https://ec.europa.eu/eurostat/data/database?node_code=hlth_cd_apr</a>
</p>

<p>
<code>icd10</code> refers to the International Statistical Classification of Diseases and Related Health Problems (ICD-10 2010). We use "TOTAL" here; that is, not split up into separate diseases.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_cd_apr'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"M"</span>,<span style="color: #2544bb;">"F"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span> <span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.mortalit.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"PRVT"</span>,<span style="color: #2544bb;">"TRT"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.unit == <span style="color: #2544bb;">"RT"</span><span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.icd10 == <span style="color: #2544bb;">"TOTAL"</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"icd10"</span>,<span style="color: #2544bb;">"geo"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span>,<span style="color: #2544bb;">'mortalit'</span><span style="color: #5317ac;">]</span>,
                        value_vars=np.arange<span style="color: #5317ac;">(</span>2011,2018<span style="color: #5317ac;">)</span>,
                        var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'rate'</span><span style="color: #145c33;">)</span>
df.set_index<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'sex'</span>,<span style="color: #2544bb;">'mortalit'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df.unstack<span style="color: #145c33;">()</span>
df.reset_index<span style="color: #145c33;">(</span>inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df.columns</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">' '</span>.join<span style="color: #5317ac;">(</span>col<span style="color: #5317ac;">)</span>.strip<span style="color: #5317ac;">()</span> <span style="color: #5317ac;">for</span> col <span style="color: #5317ac;">in</span> df.columns.values<span style="color: #145c33;">]</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'rate PRVT'</span>:<span style="color: #2544bb;">'Preventable mortality'</span>, <span style="color: #2544bb;">'rate TRT'</span>:<span style="color: #2544bb;">'Treatable mortality'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/preventable_mortality.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
   country  year sex  Preventable mortality  Treatable mortality
0  Austria  2011   F                  95.29                67.41
1  Austria  2011   M                 248.50                96.86
2  Austria  2012   F                  96.16                69.72
3  Austria  2012   M                 252.28                91.45
4  Austria  2013   F                  93.22                66.84
</pre>
</div>


<div id="outline-container-orgaecdf36" class="outline-4">
<h4 id="orgaecdf36"><span class="section-number-4">4.1.1</span> for robustness analysis</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
In the robustness analyses, we also use potential years of life lost and self-perceived health.
</p>
</div>

<ol class="org-ol">
<li><a id="orgcf32489"></a>potential years of life lost [hlth_cd_apyll]<br />
<div class="outline-text-5" id="text-4-1-1-1">
<p>
Link to data on potential years of life lost by residence:
<a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_cd_apyll/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_cd_apyll/default/table?lang=en</a>
According to: <a href="https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm">https://ec.europa.eu/eurostat/cache/metadata/en/hlth_cdeath_esms.htm</a>
"Potential Years of Life Lost (PYLL) &#x2026; is an indicator estimating the potential years lost due to premature death, i.e. death before 70. It is calculated by summing the number of years between the age at death and 70 years for each premature death. PYLL rate is expressed per 100 000 age-standardised population under 70."
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_cd_apyll'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"M"</span>,<span style="color: #2544bb;">"F"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span> <span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.icd10 == <span style="color: #2544bb;">"A-R_V-Y"</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"icd10"</span>,<span style="color: #2544bb;">"geo"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>,
                        value_vars=np.arange<span style="color: #5317ac;">(</span>2011,2018<span style="color: #5317ac;">)</span>,
                        var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'potential years of life lost'</span><span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/years_lost.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
       country sex  year  potential years of life lost
0      Austria   F  2011                        2381.0
1      Belgium   F  2011                        2783.0
2     Bulgaria   F  2011                        4491.0
3  Switzerland   F  2011                        2072.0
4       Cyprus   F  2011                        1745.0
</pre>
</div>
</li>


<li><a id="orgae73357"></a>self-perceived health [hlth_silc_10]<br />
<div class="outline-text-5" id="text-4-1-1-2">
<p>
Link to data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_silc_10/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_silc_10/default/table?lang=en</a>
</p>

<p>
We combine percentage of population (age 16 and older) reporting to be in "Very Good - Good" health (<code>VG_G</code>) and percentage "Bad - Very Bad" (<code>B_VB</code>).
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_silc_10'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"M"</span>,<span style="color: #2544bb;">"F"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span> <span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.levels.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"VG_G"</span>,<span style="color: #2544bb;">"B_VB"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span> &amp;  <span style="color: #5317ac;">(</span>df.age == <span style="color: #2544bb;">"Y_GE16"</span><span style="color: #5317ac;">)</span> &amp;<span style="color: #5317ac;">(</span>df<span style="color: #005a5f;">[</span><span style="color: #2544bb;">'quantile'</span><span style="color: #005a5f;">]</span> == <span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"quantile"</span>,<span style="color: #2544bb;">"geo"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span>,<span style="color: #2544bb;">'levels'</span><span style="color: #5317ac;">]</span>,
                        value_vars=np.arange<span style="color: #5317ac;">(</span>2011,2020<span style="color: #5317ac;">)</span>,
                        var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'rate'</span><span style="color: #145c33;">)</span>
df.set_index<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'sex'</span>,<span style="color: #2544bb;">'levels'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df.unstack<span style="color: #145c33;">()</span>
df.reset_index<span style="color: #145c33;">(</span>inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df.columns</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">' '</span>.join<span style="color: #5317ac;">(</span>col<span style="color: #5317ac;">)</span>.strip<span style="color: #5317ac;">()</span> <span style="color: #5317ac;">for</span> col <span style="color: #5317ac;">in</span> df.columns.values<span style="color: #145c33;">]</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'rate B_VB'</span>:<span style="color: #2544bb;">'Bad Very Bad'</span>, <span style="color: #2544bb;">'rate VG_G'</span>:<span style="color: #2544bb;">'Very Good Good'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/self_perceived_health.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
   country  year sex  Bad Very Bad  Very Good Good
0  Austria  2011   F          10.4            66.8
1  Austria  2011   M           8.4            70.8
2  Austria  2012   F           9.6            68.5
3  Austria  2012   M           8.4            71.7
4  Austria  2013   F           9.8            66.7
</pre>
</div>
</li>


<li><a id="org2cb6671"></a>median age [demo_pjanind]<br />
<div class="outline-text-5" id="text-4-1-1-3">
<p>
In the paper we consider the relation between median age of the population and mortality, as a check.
</p>

<p>
Link to data on the median age of population for males and females: <a href="https://ec.europa.eu/eurostat/databrowser/view/demo_pjanind/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/demo_pjanind/default/table?lang=en</a>
</p>

<p>
Variable name <code>MMEDAGEPOP</code> refers to "median age of population - males" and <code>FMEDAGEPOP</code> to  "median age of population - females". 
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'demo_pjanind'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.indic_de.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">'MMEDAGEPOP'</span>,<span style="color: #2544bb;">'FMEDAGEPOP'</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"geo"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'indic_de'</span><span style="color: #5317ac;">]</span>,
                        value_vars=np.arange<span style="color: #5317ac;">(</span>2011,2020<span style="color: #5317ac;">)</span>,
                        var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'median age'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'indic_de'</span>:<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
df.replace<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'MMEDAGEPOP'</span>:<span style="color: #2544bb;">'M'</span>,<span style="color: #2544bb;">'FMEDAGEPOP'</span>:<span style="color: #2544bb;">'F'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/population_age.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
       country sex  year  median age
0      Austria   F  2011        43.2
1      Belgium   F  2011        42.0
2     Bulgaria   F  2011        44.7
3  Switzerland   F  2011        42.5
4       Cyprus   F  2011        36.5
</pre>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org10efd40" class="outline-3">
<h3 id="org10efd40"><span class="section-number-3">4.2</span> Economic indicators</h3>
<div class="outline-text-3" id="text-4-2">
<p>
This section describes the economic indicators in our data.
</p>
</div>

<div id="outline-container-orgb781709" class="outline-4">
<h4 id="orgb781709"><span class="section-number-4">4.2.1</span> Main GDP aggregates per capita [nama_10_pc]</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
<code>B1GQ</code> refers to  "gross domestic product at market prices" and <code>CP_EUR_HAB</code> to "current prices, euro per capita".
</p>

<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/data/database?node_code=nama_10_pc">https://ec.europa.eu/eurostat/data/database?node_code=nama_10_pc</a>
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'nama_10_pc'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.na_item == <span style="color: #2544bb;">'B1GQ'</span><span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.unit == <span style="color: #2544bb;">"CP_EUR_HAB"</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"na_item"</span>,<span style="color: #2544bb;">"geo"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
df.drop<span style="color: #145c33;">(</span>np.arange<span style="color: #5317ac;">(</span>1975,2011<span style="color: #5317ac;">)</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>

<span style="color: #505050;"># </span><span style="color: #505050;">for year_column in df.columns[:10]:</span>
<span style="color: #505050;">#     </span><span style="color: #505050;">df[year_column] = df[year_column].astype(str).str.replace(r' [a-z]', '').astype(float)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span>,
                        value_vars=np.arange<span style="color: #5317ac;">(</span>2011,2021<span style="color: #5317ac;">)</span>,
                        var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'GDP per capita'</span><span style="color: #145c33;">)</span>

df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/GDP.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
       country  year  GDP per capita
0      Austria  2011         36970.0
1      Belgium  2011         34060.0
2     Bulgaria  2011          5620.0
3  Switzerland  2011         65750.0
4       Cyprus  2011         23270.0
</pre>
</div>
</div>



<div id="outline-container-org3dd269f" class="outline-4">
<h4 id="org3dd269f"><span class="section-number-4">4.2.2</span> income quantiles [icw_res_02]</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
We use income quantiles to measure income inequality in the paper. Link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/icw_res_02/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/icw_res_02/default/table?lang=en</a>
</p>

<p>
<code>INC_DISP</code> refers to disposable income.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">
<span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'icw_res_02'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'time\\geo'</span>:<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.indic_il==<span style="color: #2544bb;">'INC_DISP'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.statinfo==<span style="color: #2544bb;">'AVG'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.quant_inc.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">'QU1'</span>, <span style="color: #2544bb;">'QU2'</span>, <span style="color: #2544bb;">'QU3'</span>, <span style="color: #2544bb;">'QU4'</span>, <span style="color: #2544bb;">'QU5'</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.quant_expn==<span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.quant_wlth==<span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'unit'</span>,<span style="color: #2544bb;">'quant_expn'</span>,<span style="color: #2544bb;">'quant_wlth'</span>,<span style="color: #2544bb;">'indic_il'</span>,<span style="color: #2544bb;">'statinfo'</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'quant_inc'</span><span style="color: #5317ac;">]</span>,
                        value_vars=df.columns<span style="color: #5317ac;">[</span>2:<span style="color: #5317ac;">]</span>.values,
                        var_name=<span style="color: #2544bb;">'country'</span>,value_name=<span style="color: #2544bb;">'y_'</span><span style="color: #145c33;">)</span>


df.set_index<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'quant_inc'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df.unstack<span style="color: #145c33;">()</span>
df.reset_index<span style="color: #145c33;">(</span>inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df.columns</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">''</span>.join<span style="color: #5317ac;">(</span>col<span style="color: #5317ac;">)</span>.strip<span style="color: #5317ac;">()</span> <span style="color: #5317ac;">for</span> col <span style="color: #5317ac;">in</span> df.columns.values<span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/quantile_incomes.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
    country  year    y_QU1    y_QU2    y_QU3    y_QU4    y_QU5
0   Austria  2015  16497.2  27961.0  36682.2  48215.5  74495.5
1   Belgium  2015  15759.0  23305.9  33245.0  44850.4  68273.3
2  Bulgaria  2015   1847.7   3270.1   5115.9   7451.6  14354.6
3    Cyprus  2015  11467.4  18180.6  25357.4  35763.9  60673.0
4   Czechia  2015   5855.1   9334.9  12419.9  16699.2  26053.4
</pre>
</div>
</div>
</div>


<div id="outline-container-orgee3154c" class="outline-3">
<h3 id="orgee3154c"><span class="section-number-3">4.3</span> healthcare expenditures by function [hlth_sha11_hc]</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/data/database?node_code=hlth_sha11_hc">https://ec.europa.eu/eurostat/data/database?node_code=hlth_sha11_hc</a>
</p>

<p>
We work with expenditures in euros per inhabitant (<code>EUR_HAB</code>).
</p>

<p>
In the code, we use regex <code>' [a-z]*'</code> to capture one or more letters in the data set and delete the letters. We focus on the main health spending categories HC1-HC7.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_sha11_hc'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span> &amp; <span style="color: #5317ac;">(</span>df.unit.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">"EUR_HAB"</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"geo"</span>,<span style="color: #2544bb;">"unit"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'icha11_hc'</span><span style="color: #5317ac;">]</span>,
   value_vars=np.arange<span style="color: #5317ac;">(</span>2009,2019<span style="color: #5317ac;">)</span>,
   var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'expenditure'</span><span style="color: #145c33;">)</span>
df.set_index<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'icha11_hc'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df.unstack<span style="color: #145c33;">()</span>
df.reset_index<span style="color: #145c33;">(</span>inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df.columns</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">' '</span>.join<span style="color: #5317ac;">(</span>col<span style="color: #5317ac;">)</span>.strip<span style="color: #5317ac;">()</span> <span style="color: #5317ac;">for</span> col <span style="color: #5317ac;">in</span> df.columns.values<span style="color: #145c33;">]</span>
df.rename<span style="color: #145c33;">(</span>columns=<span style="color: #5317ac;">lambda</span> x: x.lstrip<span style="color: #5317ac;">(</span><span style="color: #2544bb;">'^expenditure '</span><span style="color: #5317ac;">)</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'HC11'</span>, <span style="color: #2544bb;">'HC11_21'</span>, <span style="color: #2544bb;">'HC12'</span>, <span style="color: #2544bb;">'HC12_22'</span>, <span style="color: #2544bb;">'HC13'</span>,
        <span style="color: #2544bb;">'HC131'</span>, <span style="color: #2544bb;">'HC132'</span>, <span style="color: #2544bb;">'HC133'</span>, <span style="color: #2544bb;">'HC139'</span>, <span style="color: #2544bb;">'HC13_23'</span>, <span style="color: #2544bb;">'HC14'</span>, <span style="color: #2544bb;">'HC14_24'</span>,
        <span style="color: #2544bb;">'HC1_2'</span>, <span style="color: #2544bb;">'HC21'</span>, <span style="color: #2544bb;">'HC22'</span>, <span style="color: #2544bb;">'HC23'</span>, <span style="color: #2544bb;">'HC24'</span>, <span style="color: #2544bb;">'HC31'</span>, <span style="color: #2544bb;">'HC32'</span>,
        <span style="color: #2544bb;">'HC33'</span>, <span style="color: #2544bb;">'HC34'</span>, <span style="color: #2544bb;">'HC41'</span>, <span style="color: #2544bb;">'HC42'</span>, <span style="color: #2544bb;">'HC43'</span>, <span style="color: #2544bb;">'HC51'</span>, <span style="color: #2544bb;">'HC511'</span>,
        <span style="color: #2544bb;">'HC512'</span>, <span style="color: #2544bb;">'HC513'</span>, <span style="color: #2544bb;">'HC52'</span>, <span style="color: #2544bb;">'HC61'</span>, <span style="color: #2544bb;">'HC62'</span>, <span style="color: #2544bb;">'HC63'</span>, <span style="color: #2544bb;">'HC64'</span>, <span style="color: #2544bb;">'HC65'</span>,
        <span style="color: #2544bb;">'HC66'</span>, <span style="color: #2544bb;">'HC71'</span>, <span style="color: #2544bb;">'HC72'</span>, <span style="color: #2544bb;">'HCR1'</span>, <span style="color: #2544bb;">'HC_UNK'</span>, <span style="color: #2544bb;">'TOT_HC'</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>

df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/expenditure_financing_by_function.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
   country  year      HC1     HC2     HC3     HC4     HC5    HC6     HC7
0  Austria  2009  1885.14  209.35  507.17  115.17  601.13  72.29  140.09
1  Austria  2010  1929.45  216.82  529.17  116.54  610.51  74.34  139.35
2  Austria  2011  1965.68  229.89  542.67  115.73  632.45  75.80  143.13
3  Austria  2012  2047.37  244.58  564.93  121.00  648.89  76.02  152.48
4  Austria  2013  2063.98  256.80  587.97  123.03  657.19  80.64  159.31
</pre>
</div>
</div>


<div id="outline-container-org3ac3018" class="outline-3">
<h3 id="org3ac3018"><span class="section-number-3">4.4</span> lifestyle determinants of health</h3>
<div class="outline-text-3" id="text-4-4">
<p>
In the paper we work with three lifestyle variables: body mass index, alcohol and tobacco consumption.
</p>
</div>

<div id="outline-container-orga6fa6f7" class="outline-4">
<h4 id="orga6fa6f7"><span class="section-number-4">4.4.1</span> Body mass index (BMI) by sex, age and income quintile [hlth_ehis_bm1]</h4>
<div class="outline-text-4" id="text-4-4-1">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/HLTH_EHIS_BM1I__custom_389481/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/HLTH_EHIS_BM1I__custom_389481/default/table?lang=en</a>
</p>

<p>
Overview of the categories in the data (we work with <code>BMI_GE30</code> in the age range 15-64):
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">BMI</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">BMI_LT18P5</td>
<td class="org-left">Underweight</td>
</tr>

<tr>
<td class="org-left">BMI18P5-24</td>
<td class="org-left">Normal</td>
</tr>

<tr>
<td class="org-left">BMI_GE30</td>
<td class="org-left">Obese</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_ehis_bm1i'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'time\\geo'</span>:<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.bmi==<span style="color: #2544bb;">'BMI_GE30'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df<span style="color: #005a5f;">[</span><span style="color: #2544bb;">'quantile'</span><span style="color: #005a5f;">]</span>==<span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">'F'</span>,<span style="color: #2544bb;">'M'</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.age==<span style="color: #2544bb;">'Y15-64'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"quantile"</span>,<span style="color: #2544bb;">"age"</span>,<span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"bmi"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>,
     value_vars=df.columns<span style="color: #5317ac;">[</span>2:<span style="color: #5317ac;">]</span>,
     var_name=<span style="color: #2544bb;">'geo'</span>,value_name=<span style="color: #2544bb;">'high bmi'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'geo'</span>,<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'high bmi'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'high bmi'</span><span style="color: #145c33;">]</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>/100.0
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/high_bmi.csv'</span><span style="color: #145c33;">)</span>

df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
  sex  high bmi   country
4   F     0.129   Belgium
5   M     0.126   Belgium
6   F     0.116  Bulgaria
7   M     0.146  Bulgaria
8   F     0.160   Czechia
</pre>
</div>
</div>

<div id="outline-container-org9df8a18" class="outline-4">
<h4 id="org9df8a18"><span class="section-number-4">4.4.2</span> Daily smokers of cigarettes by sex, age and income quintile [hlth_ehis_sk3i]</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/HLTH_EHIS_SK3I__custom_389732/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/HLTH_EHIS_SK3I__custom_389732/default/table?lang=en</a>
</p>

<p>
We choose fraction of people smoking 20 or more cigarettes a day (<code>SM_GE20D</code>) in the age category 15-64.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">code</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">TOTAL</td>
<td class="org-left">Total</td>
</tr>

<tr>
<td class="org-left">SM_LT20D</td>
<td class="org-left">Less than 20 cigarettes per day</td>
</tr>

<tr>
<td class="org-left">SM_GE20D</td>
<td class="org-left">20 or more cigarettes per day</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_ehis_sk3i'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'time\\geo'</span>:<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.age==<span style="color: #2544bb;">'Y15-64'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.smoking==<span style="color: #2544bb;">'SM_GE20D'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df<span style="color: #005a5f;">[</span><span style="color: #2544bb;">'quantile'</span><span style="color: #005a5f;">]</span>==<span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">'F'</span>,<span style="color: #2544bb;">'M'</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"quantile"</span>,<span style="color: #2544bb;">"age"</span>,<span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"smoking"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>,
     value_vars=df.columns<span style="color: #5317ac;">[</span>2:<span style="color: #5317ac;">]</span>,
     var_name=<span style="color: #2544bb;">'geo'</span>,value_name=<span style="color: #2544bb;">'smoking'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'geo'</span>,<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'smoking'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'smoking'</span><span style="color: #145c33;">]</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>/100.0
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/smoking.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
  sex  smoking   country
4   F    0.063   Belgium
5   M    0.089   Belgium
6   F    0.084  Bulgaria
7   M    0.232  Bulgaria
8   F    0.029   Czechia
</pre>
</div>
</div>

<div id="outline-container-org8b5a1cc" class="outline-4">
<h4 id="org8b5a1cc"><span class="section-number-4">4.4.3</span> Frequency of heavy episodic drinking by sex, age and educational attainment level [hlth_ehis_al3e]</h4>
<div class="outline-text-4" id="text-4-4-3">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_ehis_al3e/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_ehis_al3e/default/table?lang=en</a>
</p>

<p>
Here we choose fraction of people with a "frequency of heavy drinking every month" (<code>MTH</code>), again with the age category 15-64,
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_ehis_al3e'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'time\\geo'</span>:<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.age==<span style="color: #2544bb;">'Y15-64'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.sex.isin<span style="color: #005a5f;">(</span><span style="color: #863927;">[</span><span style="color: #2544bb;">'F'</span>,<span style="color: #2544bb;">'M'</span><span style="color: #863927;">]</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.isced11==<span style="color: #2544bb;">'TOTAL'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.frequenc==<span style="color: #2544bb;">'MTH'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"isced11"</span>,<span style="color: #2544bb;">"age"</span>,<span style="color: #2544bb;">"unit"</span>,<span style="color: #2544bb;">"frequenc"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>,
     value_vars=df.columns<span style="color: #5317ac;">[</span>2:<span style="color: #5317ac;">]</span>,
     var_name=<span style="color: #2544bb;">'geo'</span>,value_name=<span style="color: #2544bb;">'binge drinking'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">'geo'</span>,<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span>df.country.isin<span style="color: #5317ac;">(</span>EU_countries<span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'binge drinking'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'binge drinking'</span><span style="color: #145c33;">]</span>.astype<span style="color: #145c33;">(</span><span style="color: #8f0075;">float</span><span style="color: #145c33;">)</span>/100.0
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/alcohol.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
  sex  binge drinking   country
4   F           0.162   Belgium
5   M           0.272   Belgium
6   F           0.107  Bulgaria
7   M           0.253  Bulgaria
8   F           0.089   Czechia
</pre>
</div>
</div>
</div>


<div id="outline-container-orgbb826cc" class="outline-3">
<h3 id="orgbb826cc"><span class="section-number-3">4.5</span> number of doctors and nurses</h3>
<div class="outline-text-3" id="text-4-5">
<p>
To calculate the ratio of nurses to doctor, we get the data on the number of doctors and nurses per 100k inhabitants (<code>P_HTHAB</code>).
</p>
</div>

<div id="outline-container-org3a78d96" class="outline-4">
<h4 id="org3a78d96"><span class="section-number-4">4.5.1</span> doctors [hlth_rs_prs1]</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/data/database?node_code=hlth_rs_prs1">https://ec.europa.eu/eurostat/data/database?node_code=hlth_rs_prs1</a>
</p>

<p>
We choose the general category <code>OC221</code> and doctors who are practising (<code>PRACT</code>).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">code</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">OC221</td>
<td class="org-left">Medical doctors</td>
</tr>

<tr>
<td class="org-left">OC2261</td>
<td class="org-left">Dentists</td>
</tr>

<tr>
<td class="org-left">OC2262</td>
<td class="org-left">Pharmacists</td>
</tr>

<tr>
<td class="org-left">OC2264</td>
<td class="org-left">Physiotherapists</td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_rs_prs1'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.country.isin<span style="color: #005a5f;">(</span>EU_countries<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.isco08==<span style="color: #2544bb;">'OC221'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.wstatus==<span style="color: #2544bb;">'PRACT'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df<span style="color: #005a5f;">[</span><span style="color: #2544bb;">'unit'</span><span style="color: #005a5f;">]</span>==<span style="color: #2544bb;">'P_HTHAB'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"isco08"</span>,<span style="color: #2544bb;">"geo"</span>,<span style="color: #2544bb;">"wstatus"</span>,<span style="color: #2544bb;">"unit"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span>,
     value_vars=np.arange<span style="color: #5317ac;">(</span>2006,2020<span style="color: #5317ac;">)</span>,
     var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'Practising medical doctors per 100k'</span><span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/doctors.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
       country  year  Practising medical doctors per 100k
0      Austria  2006                               444.96
1      Belgium  2006                               288.59
2     Bulgaria  2006                               369.50
3  Switzerland  2006                               378.72
4       Cyprus  2006                               255.80
</pre>
</div>
</div>


<div id="outline-container-orgae94b9d" class="outline-4">
<h4 id="orgae94b9d"><span class="section-number-4">4.5.2</span> nurses [hlth_rs_prsns]</h4>
<div class="outline-text-4" id="text-4-5-2">
<p>
Link to the data: <a href="https://ec.europa.eu/eurostat/databrowser/view/hlth_rs_prsns/default/table?lang=en">https://ec.europa.eu/eurostat/databrowser/view/hlth_rs_prsns/default/table?lang=en</a>
</p>

<p>
We work with nurses and midwifes (<code>OC222_322</code>) who are practising (<code>PRACT</code>) per hundred thousand inhabitants (<code>P_HTHAB</code>).
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00538b;">df</span> = eurostat.get_data_df<span style="color: #145c33;">(</span><span style="color: #2544bb;">'hlth_rs_prsns'</span><span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'geo\\time'</span>:<span style="color: #2544bb;">'geo'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span><span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span> = df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'geo'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span>eurostat_dictionary<span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df<span style="color: #145c33;">[</span><span style="color: #5317ac;">(</span>df.country.isin<span style="color: #005a5f;">(</span>EU_countries<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.isco08==<span style="color: #2544bb;">'OC222_322'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df.wstatus==<span style="color: #2544bb;">'PRACT'</span><span style="color: #5317ac;">)</span>&amp;<span style="color: #5317ac;">(</span>df<span style="color: #005a5f;">[</span><span style="color: #2544bb;">'unit'</span><span style="color: #005a5f;">]</span>==<span style="color: #2544bb;">'P_HTHAB'</span><span style="color: #5317ac;">)</span><span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"isco08"</span>,<span style="color: #2544bb;">"geo"</span>,<span style="color: #2544bb;">"wstatus"</span>,<span style="color: #2544bb;">"unit"</span><span style="color: #5317ac;">]</span>,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df</span> = pd.melt<span style="color: #145c33;">(</span>df,id_vars=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span>,
     value_vars=np.arange<span style="color: #5317ac;">(</span>2006,2020<span style="color: #5317ac;">)</span>,
     var_name=<span style="color: #2544bb;">'year'</span>,value_name=<span style="color: #2544bb;">'Practising nurses and midwives per 100k'</span><span style="color: #145c33;">)</span>
df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/nurses.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example">
       country  year  Practising nurses and midwives per 100k
0      Austria  2006                                   635.47
1      Belgium  2006                                   959.70
2     Bulgaria  2006                                   460.83
3  Switzerland  2006                                  1333.51
4       Cyprus  2006                                      NaN
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgfde219c" class="outline-2">
<h2 id="orgfde219c"><span class="section-number-2">5</span> merging European data</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org2b1fa4f" class="outline-3">
<h3 id="org2b1fa4f"><span class="section-number-3">5.1</span> merging the health and economic data</h3>
<div class="outline-text-3" id="text-5-1">
<p>
This section merges all the health and economic data sets created above. For each of the data sets in the files lists, we specify the dimensions of the variable; i.e. whether it varies by country (GEO), gender (sex) and year (TIME).
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #5317ac;">import</span> pandas <span style="color: #5317ac;">as</span> pd

<span style="color: #00538b;">df</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/preventable_mortality.csv'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">files_list</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">'doctors.csv'</span>,<span style="color: #2544bb;">'GDP.csv'</span>,<span style="color: #2544bb;">'nurses.csv'</span>,<span style="color: #2544bb;">'asthma_copd.csv'</span>,<span style="color: #2544bb;">'expenditure_financing_by_function.csv'</span><span style="color: #145c33;">]</span> <span style="color: #505050;"># </span><span style="color: #505050;">GEO, TIME  </span>

<span style="color: #00538b;">second_list</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">'high_bmi.csv'</span>,<span style="color: #2544bb;">'smoking.csv'</span>,<span style="color: #2544bb;">'alcohol.csv'</span><span style="color: #145c33;">]</span> <span style="color: #505050;"># </span><span style="color: #505050;">GEO, sex</span>

<span style="color: #00538b;">third_list</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">'years_lost.csv'</span>,<span style="color: #2544bb;">'population_age.csv'</span>, <span style="color: #2544bb;">'self_perceived_health.csv'</span><span style="color: #145c33;">]</span> <span style="color: #505050;"># </span><span style="color: #505050;">GEO, TIME, sex </span>


<span style="color: #00538b;">fourth_list</span> = <span style="color: #145c33;">[</span><span style="color: #2544bb;">'quantile_incomes.csv'</span><span style="color: #145c33;">]</span> <span style="color: #505050;"># </span><span style="color: #505050;">GEO</span>

<span style="color: #5317ac;">for</span> f <span style="color: #5317ac;">in</span> third_list:
    <span style="color: #00538b;">df_new</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/'</span>+f<span style="color: #145c33;">)</span>
    <span style="color: #00538b;">df</span>=df.merge<span style="color: #145c33;">(</span>df_new,how=<span style="color: #2544bb;">'left'</span>,left_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>, right_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'year'</span>,<span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>

<span style="color: #5317ac;">for</span> f <span style="color: #5317ac;">in</span> second_list:
    <span style="color: #00538b;">df_new</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/'</span>+f<span style="color: #145c33;">)</span>
    <span style="color: #00538b;">df</span>=df.merge<span style="color: #145c33;">(</span>df_new,how=<span style="color: #2544bb;">'left'</span>,left_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span>, right_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'sex'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>

    
<span style="color: #5317ac;">for</span> f <span style="color: #5317ac;">in</span> files_list:
    <span style="color: #00538b;">df_new</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/'</span>+f<span style="color: #145c33;">)</span>
    <span style="color: #00538b;">df</span>=df.merge<span style="color: #145c33;">(</span>df_new,how=<span style="color: #2544bb;">'left'</span>,left_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">]</span>, right_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span>,<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>
    
<span style="color: #5317ac;">for</span> f <span style="color: #5317ac;">in</span> fourth_list:
    <span style="color: #00538b;">df_new</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/'</span>+f<span style="color: #145c33;">)</span>
    <span style="color: #00538b;">df</span>=df.merge<span style="color: #145c33;">(</span>df_new,how=<span style="color: #2544bb;">'left'</span>,left_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span>, right_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">columns_to_drop</span> = <span style="color: #145c33;">[</span>s <span style="color: #5317ac;">for</span> s <span style="color: #5317ac;">in</span> df.columns <span style="color: #5317ac;">if</span> <span style="color: #2544bb;">'Unnamed'</span> <span style="color: #5317ac;">in</span> s<span style="color: #145c33;">]</span>
df.drop<span style="color: #145c33;">(</span>columns_to_drop,axis=1,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>
df<span style="color: #145c33;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #145c33;">]</span>.replace<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'Germany (until 1990 former territory of the FRG)'</span>:<span style="color: #2544bb;">'Germany'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span><span style="color: #145c33;">)</span>

df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/health_data.csv'</span><span style="color: #145c33;">)</span>
df.head<span style="color: #145c33;">()</span>
</pre>
</div>

<pre class="example" id="org754857d">
   country  year_x sex  Preventable mortality  Treatable mortality  \
0  Austria    2011   F                  95.29                67.41   
1  Austria    2011   M                 248.50                96.86   
2  Austria    2012   F                  96.16                69.72   
3  Austria    2012   M                 252.28                91.45   
4  Austria    2013   F                  93.22                66.84   

   potential years of life lost  median age  Bad Very Bad  Very Good Good  \
0                        2381.0        43.2          10.4            66.8   
1                        4608.0        40.9           8.4            70.8   
2                        2326.0        43.5           9.6            68.5   
3                        4390.0        41.2           8.4            71.7   
4                        2245.0        43.8           9.8            66.7   

   high bmi  ...     HC4     HC5    HC6     HC7  year_y    y_QU1    y_QU2  \
0     0.113  ...  115.73  632.45  75.80  143.13  2015.0  16497.2  27961.0   
1     0.146  ...  115.73  632.45  75.80  143.13  2015.0  16497.2  27961.0   
2     0.113  ...  121.00  648.89  76.02  152.48  2015.0  16497.2  27961.0   
3     0.146  ...  121.00  648.89  76.02  152.48  2015.0  16497.2  27961.0   
4     0.113  ...  123.03  657.19  80.64  159.31  2015.0  16497.2  27961.0   

     y_QU3    y_QU4    y_QU5  
0  36682.2  48215.5  74495.5  
1  36682.2  48215.5  74495.5  
2  36682.2  48215.5  74495.5  
3  36682.2  48215.5  74495.5  
4  36682.2  48215.5  74495.5  

[5 rows x 29 columns]
</pre>
</div>
</div>


<div id="outline-container-orga6db0b2" class="outline-3">
<h3 id="orga6db0b2"><span class="section-number-3">5.2</span> merging with systems data</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Here we merge the health and economic data created above with the health system data from the OECD.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #5317ac;">import</span> pandas <span style="color: #5317ac;">as</span> pd

<span style="color: #00538b;">df_systems_data</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/oecd_systems.csv'</span><span style="color: #145c33;">)</span>
<span style="color: #00538b;">df_health_data</span> = pd.read_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/health_data.csv'</span><span style="color: #145c33;">)</span>

<span style="color: #00538b;">df</span> = df_health_data.merge<span style="color: #145c33;">(</span>df_systems_data,how=<span style="color: #2544bb;">'inner'</span>,left_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span>, right_on=<span style="color: #5317ac;">[</span><span style="color: #2544bb;">'country'</span><span style="color: #5317ac;">]</span><span style="color: #145c33;">)</span>

df.drop<span style="color: #145c33;">(</span><span style="color: #5317ac;">[</span><span style="color: #2544bb;">"Unnamed: 0_x"</span>,<span style="color: #2544bb;">"Unnamed: 0_y"</span><span style="color: #5317ac;">]</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
df.rename<span style="color: #145c33;">(</span><span style="color: #5317ac;">{</span><span style="color: #2544bb;">'year_x'</span>:<span style="color: #2544bb;">'year'</span><span style="color: #5317ac;">}</span>,inplace=<span style="color: #0000c0;">True</span>,axis=1<span style="color: #145c33;">)</span>
<span style="color: #505050;"># </span><span style="color: #505050;">columns_to_drop = [s for s in df.columns if 'TIME' in s]</span>
<span style="color: #505050;"># </span><span style="color: #505050;">df.drop(columns_to_drop,axis=1,inplace=True)</span>

df.to_csv<span style="color: #145c33;">(</span><span style="color: #2544bb;">'./data/health_and_systems_data.csv'</span><span style="color: #145c33;">)</span>
<span style="color: #8f0075;">len</span><span style="color: #145c33;">(</span>df<span style="color: #145c33;">)</span>
</pre>
</div>


<pre class="example">
336
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jan Boone</p>
</div>
</body>
</html>
